import React, { useState } from 'react';
import { ChefHat, Clock, Thermometer, Coffee, Snowflake, AlertCircle, Search, ArrowLeft } from 'lucide-react';

const StaffRecipeGuide = () => {
  const [selectedRecipe, setSelectedRecipe] = useState(null);
  const [searchTerm, setSearchTerm] = useState('');
  const [temperatureFilter, setTemperatureFilter] = useState('all');
  const [currentStep, setCurrentStep] = useState(0);

  // Clean recipe data focused on staff needs
  const recipes = [
    {
      id: 6,
      name: "Thai Iced Coffee",
      subtitle: "Gafae Yen",
      category: "thai",
      description: "Traditional Thai coffee with condensed milk",
      prep_time: 5,
      difficulty: "easy",
      temperature: "cold",
      icon: "üáπüá≠",
      color: "orange",
      ingredients: [
        { name: "Thai Coffee Powder", quantity: 25, unit: "g", notes: "Traditional blend" },
        { name: "Sweetened Condensed Milk", quantity: 40, unit: "ml", notes: "While coffee is hot" },
        { name: "Evaporated Milk", quantity: 30, unit: "ml", notes: "For floating layer" },
        { name: "Sugar", quantity: 15, unit: "g", notes: "Adjust to taste" },
        { name: "Ice Cubes", quantity: 200, unit: "g", notes: "Fill tall glass" }
      ],
      instructions: [
        {
          step: 1,
          title: "Brew Coffee",
          description: "Brew strong coffee with 25g Thai coffee powder using 200ml hot water at 90-95¬∞C",
          time: "2 min",
          tips: "Let coffee drip slowly for best flavor"
        },
        {
          step: 2,
          title: "Add Sweeteners",
          description: "While coffee is hot, add condensed milk and sugar. Stir well",
          time: "30 sec",
          tips: "Mix while hot so sugar dissolves completely"
        },
        {
          step: 3,
          title: "Cool Down",
          description: "Let coffee mixture cool for 2-3 minutes",
          time: "3 min",
          tips: "Don't rush - hot coffee melts ice too fast"
        },
        {
          step: 4,
          title: "Add Ice",
          description: "Fill tall glass with ice cubes",
          time: "15 sec",
          tips: "Use tall glass for proper presentation"
        },
        {
          step: 5,
          title: "Pour & Float",
          description: "Pour coffee over ice, then float evaporated milk on top",
          time: "30 sec",
          tips: "Pour milk slowly over spoon back for layers"
        }
      ]
    },
    {
      id: 1,
      name: "Cappuccino",
      subtitle: "Classic Italian",
      category: "coffee",
      description: "Espresso with steamed milk and foam",
      prep_time: 3,
      difficulty: "medium",
      temperature: "hot",
      icon: "‚òï",
      color: "red",
      ingredients: [
        { name: "Arabica Coffee Beans", quantity: 18, unit: "g", notes: "Freshly ground fine" },
        { name: "Cold Milk", quantity: 150, unit: "ml", notes: "3.25% fat content" }
      ],
      instructions: [
        {
          step: 1,
          title: "Grind & Dose",
          description: "Grind 18g coffee beans fine, dose into portafilter",
          time: "30 sec",
          tips: "Grind should feel like fine sand"
        },
        {
          step: 2,
          title: "Tamp",
          description: "Level and tamp with 30lbs pressure",
          time: "15 sec",
          tips: "Keep tamper level, consistent pressure"
        },
        {
          step: 3,
          title: "Extract Espresso",
          description: "Brew shot - 30-35ml in 25-30 seconds",
          time: "30 sec",
          tips: "Watch for golden crema formation"
        },
        {
          step: 4,
          title: "Steam Milk",
          description: "Steam 150ml milk to 65¬∞C with microfoam",
          time: "45 sec",
          tips: "Keep wand just below surface first, then deeper"
        },
        {
          step: 5,
          title: "Pour",
          description: "Pour steamed milk creating latte art",
          time: "30 sec",
          tips: "Pour from height first, then closer for art"
        }
      ]
    },
    {
      id: 8,
      name: "Iced Latte",
      subtitle: "Cold Coffee",
      category: "coffee",
      description: "Espresso with cold milk over ice",
      prep_time: 3,
      difficulty: "easy",
      temperature: "cold",
      icon: "üßä",
      color: "blue",
      ingredients: [
        { name: "Arabica Coffee Beans", quantity: 18, unit: "g", notes: "Freshly ground" },
        { name: "Cold Milk", quantity: 200, unit: "ml", notes: "Keep refrigerated" },
        { name: "Ice Cubes", quantity: 150, unit: "g", notes: "Fill glass 3/4" }
      ],
      instructions: [
        {
          step: 1,
          title: "Extract Espresso",
          description: "Grind and extract 18g espresso shot",
          time: "1 min",
          tips: "Same technique as hot drinks"
        },
        {
          step: 2,
          title: "Prepare Glass",
          description: "Fill 16oz glass with ice cubes",
          time: "15 sec",
          tips: "Use large glass for milk and foam"
        },
        {
          step: 3,
          title: "Add Milk",
          description: "Pour cold milk over ice",
          time: "15 sec",
          tips: "Pour slowly to avoid splashing"
        },
        {
          step: 4,
          title: "Add Espresso",
          description: "Pour hot espresso over milk and ice",
          time: "15 sec",
          tips: "Hot espresso creates natural mixing"
        },
        {
          step: 5,
          title: "Stir & Serve",
          description: "Give gentle stir and serve with straw",
          time: "15 sec",
          tips: "One gentle stir only"
        }
      ]
    },
    {
      id: 9,
      name: "Thai Coffee Frappe",
      subtitle: "Blended",
      category: "thai",
      description: "Blended coffee with condensed milk",
      prep_time: 4,
      difficulty: "medium",
      temperature: "cold",
      icon: "ü•§",
      color: "orange",
      ingredients: [
        { name: "Thai Coffee Powder", quantity: 30, unit: "g", notes: "Strong brew" },
        { name: "Sweetened Condensed Milk", quantity: 50, unit: "ml", notes: "For sweetness" },
        { name: "Whipped Cream", quantity: 30, unit: "ml", notes: "For topping" },
        { name: "Ice Cubes", quantity: 250, unit: "g", notes: "For blending" },
        { name: "Sugar", quantity: 20, unit: "g", notes: "Extra sweetness" }
      ],
      instructions: [
        {
          step: 1,
          title: "Brew Coffee",
          description: "Brew extra strong coffee with 30g powder, let cool completely",
          time: "3 min",
          tips: "Must be completely cool before blending"
        },
        {
          step: 2,
          title: "Add to Blender",
          description: "Add cooled coffee, ice, condensed milk, and sugar to blender",
          time: "30 sec",
          tips: "Add ice last to protect blender blade"
        },
        {
          step: 3,
          title: "Blend",
          description: "Blend on high for 45-60 seconds until frothy",
          time: "1 min",
          tips: "No ice chunks should remain"
        },
        {
          step: 4,
          title: "Pour",
          description: "Pour into tall glass, leave room for cream",
          time: "30 sec",
          tips: "Use tall glass for presentation"
        },
        {
          step: 5,
          title: "Top",
          description: "Add whipped cream in decorative swirl",
          time: "30 sec",
          tips: "Can dust with coffee powder"
        }
      ]
    },
    {
      id: 11,
      name: "Iced Mocha",
      subtitle: "Chocolate Coffee",
      category: "coffee",
      description: "Coffee with chocolate and whipped cream",
      prep_time: 4,
      difficulty: "medium",
      temperature: "cold",
      icon: "üç´",
      color: "brown",
      ingredients: [
        { name: "Arabica Coffee Beans", quantity: 18, unit: "g", notes: "Double shot" },
        { name: "Cold Milk", quantity: 150, unit: "ml", notes: "Helps cool mixture" },
        { name: "Chocolate Syrup", quantity: 30, unit: "ml", notes: "Hershey's preferred" },
        { name: "Whipped Cream", quantity: 40, unit: "ml", notes: "For topping" },
        { name: "Ice Cubes", quantity: 180, unit: "g", notes: "Fill glass well" }
      ],
      instructions: [
        {
          step: 1,
          title: "Extract Espresso",
          description: "Prepare double espresso shot",
          time: "1 min",
          tips: "Extract into mixing cup"
        },
        {
          step: 2,
          title: "Mix Chocolate",
          description: "Mix chocolate syrup into hot espresso thoroughly",
          time: "30 sec",
          tips: "Mix while hot for smooth blend"
        },
        {
          step: 3,
          title: "Add Milk",
          description: "Add cold milk to chocolate-coffee mixture",
          time: "15 sec",
          tips: "Helps cool before adding to ice"
        },
        {
          step: 4,
          title: "Pour Over Ice",
          description: "Fill glass with ice, pour mixture over",
          time: "30 sec",
          tips: "Pour slowly for nice layering"
        },
        {
          step: 5,
          title: "Top & Garnish",
          description: "Add whipped cream and drizzle extra chocolate",
          time: "45 sec",
          tips: "Create decorative pattern"
        }
      ]
    },
    {
      id: 4,
      name: "Chocolate Muffin",
      subtitle: "Fresh Baked",
      category: "pastry",
      description: "Rich chocolate muffin",
      prep_time: 25,
      difficulty: "medium",
      temperature: "baked",
      icon: "üßÅ",
      color: "purple",
      ingredients: [
        { name: "All Purpose Flour", quantity: 60, unit: "g", notes: "Sifted" },
        { name: "Cocoa Powder", quantity: 10, unit: "g", notes: "Unsweetened" },
        { name: "Baking Powder", quantity: 2, unit: "g", notes: "Fresh" },
        { name: "Sugar", quantity: 30, unit: "g", notes: "Granulated" },
        { name: "Egg", quantity: 0.5, unit: "piece", notes: "Room temp" },
        { name: "Milk", quantity: 50, unit: "ml", notes: "Room temp" },
        { name: "Melted Butter", quantity: 15, unit: "g", notes: "Cooled" },
        { name: "Vanilla Extract", quantity: 2, unit: "ml", notes: "Pure vanilla" }
      ],
      instructions: [
        {
          step: 1,
          title: "Preheat Oven",
          description: "Preheat to 180¬∞C, line muffin tin",
          time: "10 min",
          tips: "Oven must be fully preheated"
        },
        {
          step: 2,
          title: "Mix Dry",
          description: "Sift flour, cocoa, baking powder, sugar together",
          time: "2 min",
          tips: "Sifting prevents lumps"
        },
        {
          step: 3,
          title: "Mix Wet",
          description: "Whisk egg, milk, butter, vanilla together",
          time: "2 min",
          tips: "All room temperature for smooth mixing"
        },
        {
          step: 4,
          title: "Combine",
          description: "Gently fold wet into dry until just combined",
          time: "1 min",
          tips: "Don't overmix - lumpy is okay"
        },
        {
          step: 5,
          title: "Bake",
          description: "Fill cups 2/3 full, bake 18-20 minutes",
          time: "20 min",
          tips: "Don't open door first 15 minutes"
        }
      ]
    }
  ];

  const getColorClasses = (color) => {
    const colors = {
      orange: { bg: 'bg-orange-500', hover: 'hover:bg-orange-600', light: 'bg-orange-50 border-orange-200' },
      red: { bg: 'bg-red-500', hover: 'hover:bg-red-600', light: 'bg-red-50 border-red-200' },
      blue: { bg: 'bg-blue-500', hover: 'hover:bg-blue-600', light: 'bg-blue-50 border-blue-200' },
      brown: { bg: 'bg-amber-600', hover: 'hover:bg-amber-700', light: 'bg-amber-50 border-amber-200' },
      purple: { bg: 'bg-purple-500', hover: 'hover:bg-purple-600', light: 'bg-purple-50 border-purple-200' }
    };
    return colors[color] || colors.blue;
  };

  const filteredRecipes = recipes.filter(recipe => {
    const matchesSearch = recipe.name.toLowerCase().includes(searchTerm.toLowerCase());
    const matchesTemp = temperatureFilter === 'all' || recipe.temperature === temperatureFilter;
    return matchesSearch && matchesTemp;
  });

  return (
    <div className="min-h-screen bg-gray-50">
      <div className="container mx-auto px-6 py-8">
        
        {!selectedRecipe ? (
          <>
            {/* Header */}
            <div className="text-center mb-12">
              <div className="inline-flex items-center gap-4 mb-6">
                <div className="p-4 bg-orange-500 rounded-2xl text-white">
                  <ChefHat size={48} />
                </div>
                <h1 className="text-5xl font-bold text-gray-800">Recipe Guide</h1>
              </div>
              <p className="text-xl text-gray-600">Step-by-step instructions for every menu item</p>
            </div>

            {/* Temperature Filter Buttons */}
            <div className="flex justify-center gap-4 mb-8">
              <button
                onClick={() => setTemperatureFilter('all')}
                className={`px-8 py-4 rounded-2xl font-bold text-lg transition-all ${
                  temperatureFilter === 'all' 
                    ? 'bg-gray-800 text-white shadow-lg' 
                    : 'bg-white text-gray-700 hover:bg-gray-100 shadow-md'
                }`}
              >
                üçΩÔ∏è All Items
              </button>
              <button
                onClick={() => setTemperatureFilter('hot')}
                className={`px-8 py-4 rounded-2xl font-bold text-lg transition-all ${
                  temperatureFilter === 'hot' 
                    ? 'bg-red-500 text-white shadow-lg' 
                    : 'bg-white text-gray-700 hover:bg-gray-100 shadow-md'
                }`}
              >
                ‚òï Hot Drinks
              </button>
              <button
                onClick={() => setTemperatureFilter('cold')}
                className={`px-8 py-4 rounded-2xl font-bold text-lg transition-all ${
                  temperatureFilter === 'cold' 
                    ? 'bg-blue-500 text-white shadow-lg' 
                    : 'bg-white text-gray-700 hover:bg-gray-100 shadow-md'
                }`}
              >
                üßä Iced Drinks
              </button>
              <button
                onClick={() => setTemperatureFilter('baked')}
                className={`px-8 py-4 rounded-2xl font-bold text-lg transition-all ${
                  temperatureFilter === 'baked' 
                    ? 'bg-purple-500 text-white shadow-lg' 
                    : 'bg-white text-gray-700 hover:bg-gray-100 shadow-md'
                }`}
              >
                üßÅ Pastries
              </button>
            </div>

            {/* Search */}
            <div className="max-w-md mx-auto mb-12">
              <div className="relative">
                <Search className="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400" size={24} />
                <input
                  type="text"
                  placeholder="Search recipes..."
                  value={searchTerm}
                  onChange={(e) => setSearchTerm(e.target.value)}
                  className="w-full pl-12 pr-6 py-4 text-lg border-2 border-gray-200 rounded-2xl focus:ring-4 focus:ring-orange-200 focus:border-orange-500"
                />
              </div>
            </div>

            {/* Recipe Grid */}
            <div className="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8">
              {filteredRecipes.map((recipe) => {
                const colors = getColorClasses(recipe.color);
                return (
                  <button
                    key={recipe.id}
                    onClick={() => {
                      setSelectedRecipe(recipe);
                      setCurrentStep(0);
                    }}
                    className="bg-white rounded-3xl shadow-lg hover:shadow-xl transition-all transform hover:scale-105 p-8 text-left"
                  >
                    {/* Large Icon */}
                    <div className="text-center mb-6">
                      <div className="text-8xl mb-4">{recipe.icon}</div>
                      <div className={`inline-flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium ${colors.light}`}>
                        {recipe.temperature === 'hot' && <Coffee size={16} />}
                        {recipe.temperature === 'cold' && <Snowflake size={16} />}
                        {recipe.temperature === 'baked' && <Thermometer size={16} />}
                        <span className="capitalize">{recipe.temperature}</span>
                      </div>
                    </div>

                    {/* Recipe Info */}
                    <div className="text-center">
                      <h3 className="text-2xl font-bold text-gray-800 mb-2">{recipe.name}</h3>
                      <p className="text-lg text-gray-600 mb-4">{recipe.subtitle}</p>
                      <p className="text-gray-700 mb-6">{recipe.description}</p>
                      
                      {/* Time and Difficulty */}
                      <div className="flex justify-center gap-6 text-sm">
                        <div className="flex items-center gap-2">
                          <Clock size={18} className="text-gray-500" />
                          <span className="font-medium">{recipe.prep_time} min</span>
                        </div>
                        <div className={`px-3 py-1 rounded-full font-medium ${
                          recipe.difficulty === 'easy' ? 'bg-green-100 text-green-800' :
                          recipe.difficulty === 'medium' ? 'bg-yellow-100 text-yellow-800' :
                          'bg-red-100 text-red-800'
                        }`}>
                          {recipe.difficulty}
                        </div>
                      </div>
                    </div>
                  </button>
                );
              })}
            </div>
          </>
        ) : (
          /* Recipe Detail View */
          <div className="max-w-4xl mx-auto">
            {/* Back Button */}
            <button
              onClick={() => setSelectedRecipe(null)}
              className="flex items-center gap-3 mb-8 text-xl font-medium text-gray-600 hover:text-gray-800 transition-colors"
            >
              <ArrowLeft size={24} />
              Back to Recipes
            </button>

            {/* Recipe Header */}
            <div className="bg-white rounded-3xl shadow-lg p-8 mb-8">
              <div className="flex items-center gap-6 mb-6">
                <div className="text-6xl">{selectedRecipe.icon}</div>
                <div>
                  <h1 className="text-4xl font-bold text-gray-800 mb-2">{selectedRecipe.name}</h1>
                  <p className="text-xl text-gray-600 mb-4">{selectedRecipe.description}</p>
                  <div className="flex items-center gap-6">
                    <div className="flex items-center gap-2">
                      <Clock size={20} className="text-gray-500" />
                      <span className="text-lg font-medium">{selectedRecipe.prep_time} minutes</span>
                    </div>
                    <div className={`px-4 py-2 rounded-full font-medium ${
                      selectedRecipe.difficulty === 'easy' ? 'bg-green-100 text-green-800' :
                      selectedRecipe.difficulty === 'medium' ? 'bg-yellow-100 text-yellow-800' :
                      'bg-red-100 text-red-800'
                    }`}>
                      {selectedRecipe.difficulty}
                    </div>
                  </div>
                </div>
              </div>
            </div>

            {/* Ingredients */}
            <div className="bg-white rounded-3xl shadow-lg p-8 mb-8">
              <h2 className="text-3xl font-bold text-gray-800 mb-6">üõí Ingredients</h2>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                {selectedRecipe.ingredients.map((ingredient, index) => (
                  <div key={index} className="bg-gray-50 rounded-2xl p-6">
                    <div className="flex justify-between items-start mb-2">
                      <h3 className="text-lg font-bold text-gray-800">{ingredient.name}</h3>
                      <span className="text-xl font-bold text-orange-600">{ingredient.quantity} {ingredient.unit}</span>
                    </div>
                    {ingredient.notes && (
                      <p className="text-gray-600">{ingredient.notes}</p>
                    )}
                  </div>
                ))}
              </div>
            </div>

            {/* Instructions */}
            <div className="bg-white rounded-3xl shadow-lg p-8">
              <h2 className="text-3xl font-bold text-gray-800 mb-6">üë®‚Äçüç≥ Instructions</h2>
              
              {/* Step Navigation */}
              <div className="flex gap-3 mb-8 overflow-x-auto pb-2">
                {selectedRecipe.instructions.map((step, index) => {
                  const colors = getColorClasses(selectedRecipe.color);
                  return (
                    <button
                      key={index}
                      onClick={() => setCurrentStep(index)}
                      className={`px-6 py-3 rounded-2xl font-bold whitespace-nowrap transition-all ${
                        currentStep === index
                          ? `${colors.bg} text-white shadow-lg`
                          : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                      }`}
                    >
                      Step {step.step}
                    </button>
                  );
                })}
              </div>

              {/* Current Step */}
              <div className={`${getColorClasses(selectedRecipe.color).light} border-2 rounded-3xl p-8`}>
                <div className="flex items-center justify-between mb-6">
                  <h3 className="text-2xl font-bold text-gray-800">
                    Step {selectedRecipe.instructions[currentStep].step}: {selectedRecipe.instructions[currentStep].title}
                  </h3>
                  <div className="flex items-center gap-2 bg-white px-4 py-2 rounded-full">
                    <Clock size={18} className="text-gray-500" />
                    <span className="font-bold text-lg">{selectedRecipe.instructions[currentStep].time}</span>
                  </div>
                </div>
                
                <p className="text-xl text-gray-700 mb-6 leading-relaxed">
                  {selectedRecipe.instructions[currentStep].description}
                </p>
                
                {selectedRecipe.instructions[currentStep].tips && (
                  <div className="bg-yellow-50 border-2 border-yellow-200 rounded-2xl p-6">
                    <div className="flex items-center gap-3 mb-3">
                      <AlertCircle className="text-yellow-600" size={24} />
                      <span className="font-bold text-xl text-yellow-800">Pro Tip:</span>
                    </div>
                    <p className="text-lg text-yellow-700">{selectedRecipe.instructions[currentStep].tips}</p>
                  </div>
                )}
              </div>

              {/* Navigation */}
              <div className="flex justify-between mt-8">
                <button
                  onClick={() => setCurrentStep(Math.max(0, currentStep - 1))}
                  disabled={currentStep === 0}
                  className="px-8 py-4 bg-gray-200 text-gray-700 rounded-2xl font-bold text-lg hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition-all"
                >
                  ‚Üê Previous
                </button>
                <div className="flex items-center gap-4">
                  <span className="text-lg font-medium text-gray-600">
                    {currentStep + 1} of {selectedRecipe.instructions.length}
                  </span>
                </div>
                <button
                  onClick={() => setCurrentStep(Math.min(selectedRecipe.instructions.length - 1, currentStep + 1))}
                  disabled={currentStep === selectedRecipe.instructions.length - 1}
                  className={`px-8 py-4 rounded-2xl font-bold text-lg transition-all ${
                    currentStep === selectedRecipe.instructions.length - 1
                      ? 'bg-gray-200 text-gray-700 opacity-50 cursor-not-allowed'
                      : `${getColorClasses(selectedRecipe.color).bg} ${getColorClasses(selectedRecipe.color).hover} text-white`
                  }`}
                >
                  Next ‚Üí
                </button>
              </div>
            </div>
          </div>
        )}
      </div>
    </div>
  );
};

export default StaffRecipeGuide;